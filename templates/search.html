{% extends "base.html" %}

{% block title %}Search Movies - MyMovieShelf{% endblock %}

{% block content %}
<h2>Search for Movies</h2>
<form method="GET" action="/search">
    <input type="text" name="query" placeholder="Enter movie title..." value="{{ request.args.get('query', '') }}">
    <button type="submit">Search</button>
</form>

{% if request.args.get('query') %}
    <p>You searched for: "{{ request.args.get('query') }}"</p>
    
    {% if movies %}
        <h3>Results:</h3>
        {% for movie in movies %}
            <div style="border: 1px solid #ccc; padding: 10px; margin: 10px 0;">
                <p><strong>{{ movie.Title }}</strong> ({{ movie.Year }})</p>
                <p>Type: {{ movie.Type }}</p>
                
                {% if movie.already_added %}
                    <p style="color: green; font-weight: bold;">âœ… Already in Watchlist</p>
                {% else %}
                    <form method="POST" action="/add_movie" style="display: inline;">
                        <input type="hidden" name="imdb_id" value="{{ movie.imdbID }}">
                        <input type="hidden" name="title" value="{{ movie.Title }}">
                        <input type="hidden" name="year" value="{{ movie.Year }}">
                        <button type="submit">Add to Watchlist</button>
                    </form>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p><em>No movies found. Try a different search!</em></p>
    {% endif %}
{% endif %}
{% endblock %}